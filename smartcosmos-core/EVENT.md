# Event
The SnapBundle™ platform captures and persists every User's activity stream. Creation, updates, and deletes are logged in their entity into the databse using an Event model. This activity stream literally is a transaction log of who did what, when. The most common application for this activity stream is to define an [Integration Endpoint](INTEGRATION.md "Integration Endpoins") to receive and process the event stream in near real-time.

Each Account may define 1 dedicated Event Stream processing integration endpoint. This integration endpoint is defined as part of the Account object itself. In contrast, each Account may subscribe to any number of external [Extensions](EXTENSION_FRAMEWORK.md "Extension Framework") that also may be authorized to receive a near real-time event stream feed for the Account. The account to which the Extension is subscribing provides authentication and authorization via the OAuth 2.0 standard. This design means that the Extension does _not_ need to know about a specific username-password combination, instead relying on secure _bearer access tokens_ to perform operations on behalf of the Account. 

As User activity occurs in an Account, events are generated by the SnapBundle™ platform and first persisted to the database, and then dispatched to the AWS Simple Notification Service for relay to the Extension's integration endpoint.

> Extensions can be written in any modern development language, from Ruby on Rails to .NET, Python to Java, etc. Any environment that can process HTTP and JSON are viable development environments.

## Event Fields
Field | Data Type | Required | Can Update | Serialization Level | Default Value
------------ | ------------- | ------------ | ------------ | ------------ | ------------
uniqueId | long  | true | false | Restricted | Generated
urn | String  | true | false | Minimum | Generated
lastModifiedTimestamp | long   | true | false | Standard | Generated
moniker | String  | false | true | Standard | null
account | IAccount  | true | fase | Full | Restricted |
user | IUser | true | false | Minimum | Minimum |
eventType | EventType | true | false | Minimum |
source | String | true | false | Minimum |

The `lastModifiedTimestamp` represents the time the specified User performed the given operation. The operation performed must be contextually deduced from the `eventType` field. Each EventType serializes the resulting object state into the `source` field. In some situations, the `user` and/or `source` fields may be null. For example, a `UserLoginFailure` will never have a `user` object, since the login failed and no corresponding object could be definitively identified. In another example, an ObjectUpdated event would put the authenticated user into the `user` field, and place the resulting Object (as JSON) in the `source` field. By combining the `user`, `eventType`, and `source`, an Extension is able to literally monitor the state of the Account's data in real time.

One last common example worthy of discussion surrounds the definition of a [File](FILE.md "File"). Recall that the definition of a File is a two-stepped procedure. First, the File record is defined, with `pending = true` to indicate that the physical media hasn't yet been uploaded to the cloud. This state is represented with the `FileDefined` event type. If an Extension actually needs to retrieve the media from the SnapBundle™ platform, it must wait until the `FileUploaded` event triggers, indicating that the file is now ready for download from the cloud. In fact, the `FileUploaded` event's `source` will contain a JSON representation of the updated File that includes the `url` that the Extension can use to fetch the actual content.

> For a complete list of `EventType` values, please review the [EventType](DATA_TYPES.md#et "Data Types") data type definition.

## Event Endpoints

Events are generated automatically when the User interacts with the platform. There are no dedicated endpoints defined by design for creating Event objects. Use the [Search](SEARCH.md "Search") endpoint to query historical Event records.

> Event objects are by design immutable
